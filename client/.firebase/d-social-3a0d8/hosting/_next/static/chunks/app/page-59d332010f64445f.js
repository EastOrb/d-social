(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6601:function(){},4634:function(e,t,s){Promise.resolve().then(s.bind(s,8454))},8454:function(e,t,s){"use strict";s.r(t);var n=s(3827),a=s(4090),r=s(2493),i=s(2536);t.default=function(){let{contract:e}=(0,r.useContract)(),[t,s]=(0,a.useState)(""),[c,o]=(0,a.useState)(""),[l,u]=(0,a.useState)(!0),[d,m]=(0,a.useState)(""),[p,y]=(0,a.useState)([]),[f,h]=(0,a.useState)(null),[x,b]=(0,a.useState)(null),[g,v]=(0,a.useState)("");(0,a.useEffect)(()=>{(async function(){try{if(window.ethereum){let e=new i.Q(window.ethereum);await e.send("eth_requestAccounts",[]),h(e.getSigner()),u(!1)}else throw Error("Wallet connection not available.")}catch(e){console.error(e)}})()},[]),(0,a.useEffect)(()=>{(async function(){try{if(f){let t=await f.getAddress(),s=await e.getUserByAddress(t);console.log(s),s&&b(s)}}catch(e){console.error(e)}})()},[f]),(0,a.useEffect)(()=>{async function t(){try{await k()}catch(e){console.error(e),m(e.message)}}e&&t()},[e]);let w=async()=>{try{let n=await f.getAddress(),a=await e.registerUser(t,{from:n});await a.wait(),m("User registered successfully."),s(""),fetchRegisteredUser()}catch(e){console.error(e),m(e.message)}},j=async()=>{try{let t=await e.connect(f).createPost(c);await t.wait(),m("Post created successfully."),o(""),k()}catch(e){console.error(e),m(e.message)}},N=async t=>{try{let s=await e.connect(f).likePost(t);await s.wait(),m("Post liked successfully."),await k()}catch(e){console.error(e),m(e.message)}},C=async(t,s)=>{try{let n=await e.connect(f).addComment(t,s);await n.wait(),m("Comment added successfully."),k(),v("")}catch(e){console.error(e),m(e.message)}},k=async()=>{try{let t=await e.getPostsCount(),s=[];for(let n=0;n<t;n++){let t=await e.getPost(n),a=[];for(let s=0;s<t.commentsCount;s++){let t=await e.getComment(n,s);a.push(t)}s.push({...t,comments:a})}y(s),m("")}catch(e){console.error(e),m(e.message)}};return(0,n.jsxs)("div",{className:"container mt-5",children:[(0,n.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:(0,n.jsxs)("div",{className:"container-fluid",children:[(0,n.jsx)("a",{className:"navbar-brand",href:"#",children:"Social Media"}),(0,n.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:(0,n.jsx)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:x&&(0,n.jsx)("li",{className:"nav-item",children:(0,n.jsxs)("button",{disabled:!0,className:"btn btn-warning",children:[" ",x.userAddress.slice(0,6),"..."]})})})})]})}),!x&&(0,n.jsx)("div",{className:"row mt-3",children:(0,n.jsx)("div",{className:"col-md-6",children:(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:"Create Account"}),(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)("input",{type:"text",className:"form-control",placeholder:"Username",value:t,onChange:e=>s(e.target.value)})}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:w,disabled:l,children:"Register"})]})})})}),x&&(0,n.jsx)("div",{className:"row mt-3",children:(0,n.jsx)("div",{className:"col-md-6",children:(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:"Create Post"}),(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)("textarea",{className:"form-control",rows:"3",placeholder:"Content",value:c,onChange:e=>o(e.target.value)})}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:j,disabled:l,children:"Create Post"})]})})})}),(0,n.jsxs)("div",{className:"mt-3",children:[d&&(0,n.jsx)("div",{className:"alert alert-info",role:"alert",children:d}),(0,n.jsx)("h3",{children:"Posts"}),(0,n.jsx)("div",{className:"row",children:p.map((e,t)=>(0,n.jsx)("div",{className:"col-md-6 mb-3",children:(0,n.jsx)("div",{className:"card shadow p-2 ",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsxs)("h6",{className:"card-title",style:{color:"darkgrey"},children:["Author : ",e.author.toString()]}),(0,n.jsx)("p",{className:"card-text",style:{color:"darkgrey"},children:e.content}),(0,n.jsxs)("p",{className:"card-text",style:{color:"darkgrey"},children:["Likes: ",e.likes.toString()]}),x&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"btn btn-primary m-2",onClick:()=>N(t),children:"Like"}),(0,n.jsx)("input",{type:"text",className:"form-control m-2",placeholder:"Add a comment...",value:g,onChange:e=>v(e.target.value)}),(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>C(t,g),children:"Comment"})]}),(0,n.jsxs)("div",{className:"mt-3",children:[(0,n.jsx)("h5",{children:"Comments"}),e.comments.map((e,t)=>(0,n.jsx)("div",{children:(0,n.jsxs)("p",{className:"text-info",children:[e.content," ",(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"text-primary",children:"".concat(e.commenter.slice(0,6),"...").concat(e.commenter.slice(e.commenter.length-4))})]})},t))]})]})})},t))})]}),(0,n.jsx)("div",{className:"mt-5"})]})}},2493:function(e,t,s){"use strict";s.r(t),s.d(t,{ContractProvider:function(){return u},useContract:function(){return d}});var n=s(3827),a=s(4090),r=s(8400);let i=s(7731),c=s(5297),o=s(8792),l=(0,a.createContext)();function u(e){let{children:t}=e,[s,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(o),[p,y]=(0,a.useState)(c);return(0,a.useEffect)(()=>{if(!d||!p)return;let e=new i.providers.Web3Provider(window.ethereum);console.log(e);let t=e.getSigner();u(new r.CH(d,p,t))},[d,p]),(0,n.jsx)(l.Provider,{value:{contract:s},children:t})}function d(){return(0,a.useContext)(l)}},5297:function(e){"use strict";e.exports=JSON.parse('[{"type":"constructor","payable":false,"inputs":[]},{"type":"event","anonymous":false,"name":"CommentAdded","inputs":[{"type":"address","name":"commenter","indexed":true},{"type":"uint256","name":"postId","indexed":true},{"type":"string","name":"content","indexed":false},{"type":"uint256","name":"timestamp","indexed":false}]},{"type":"event","anonymous":false,"name":"PostCreated","inputs":[{"type":"address","name":"author","indexed":true},{"type":"string","name":"content","indexed":false},{"type":"uint256","name":"timestamp","indexed":false}]},{"type":"event","anonymous":false,"name":"PostLiked","inputs":[{"type":"address","name":"liker","indexed":true},{"type":"uint256","name":"postId","indexed":true}]},{"type":"event","anonymous":false,"name":"UserRegistered","inputs":[{"type":"address","name":"userAddress","indexed":true},{"type":"string","name":"username","indexed":false}]},{"type":"function","name":"addComment","constant":false,"payable":false,"inputs":[{"type":"uint256","name":"_postId"},{"type":"string","name":"_content"}],"outputs":[]},{"type":"function","name":"createPost","constant":false,"payable":false,"inputs":[{"type":"string","name":"_content"}],"outputs":[]},{"type":"function","name":"getComment","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"uint256","name":"_postId"},{"type":"uint256","name":"_commentId"}],"outputs":[{"type":"address","name":"commenter"},{"type":"string","name":"content"},{"type":"uint256","name":"timestamp"}]},{"type":"function","name":"getPost","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"uint256","name":"_postId"}],"outputs":[{"type":"address","name":"author"},{"type":"string","name":"content"},{"type":"uint256","name":"timestamp"},{"type":"uint256","name":"likes"},{"type":"uint256","name":"commentsCount"}]},{"type":"function","name":"getPostsCount","constant":true,"stateMutability":"view","payable":false,"inputs":[],"outputs":[{"type":"uint256"}]},{"type":"function","name":"getUserByAddress","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"address","name":"_userAddress"}],"outputs":[{"type":"tuple","components":[{"type":"string","name":"username"},{"type":"address","name":"userAddress"},{"type":"bool","name":"isRegistered"}]}]},{"type":"function","name":"likePost","constant":false,"payable":false,"inputs":[{"type":"uint256","name":"_postId"}],"outputs":[]},{"type":"function","name":"owner","constant":true,"stateMutability":"view","payable":false,"inputs":[],"outputs":[{"type":"address"}]},{"type":"function","name":"postComments","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"uint256"},{"type":"uint256"}],"outputs":[{"type":"address","name":"commenter"},{"type":"string","name":"content"},{"type":"uint256","name":"timestamp"}]},{"type":"function","name":"postCommentsCount","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"uint256"}],"outputs":[{"type":"uint256"}]},{"type":"function","name":"posts","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"uint256"}],"outputs":[{"type":"address","name":"author"},{"type":"string","name":"content"},{"type":"uint256","name":"timestamp"},{"type":"uint256","name":"likes"},{"type":"uint256","name":"commentsCount"}]},{"type":"function","name":"registerUser","constant":false,"payable":false,"inputs":[{"type":"string","name":"_username"}],"outputs":[]},{"type":"function","name":"users","constant":true,"stateMutability":"view","payable":false,"inputs":[{"type":"address"}],"outputs":[{"type":"string","name":"username"},{"type":"address","name":"userAddress"},{"type":"bool","name":"isRegistered"}]}]')},8792:function(e){"use strict";e.exports="0x6a611A5AFb06c6C4Ed9c724D983De8178231c9b8"}},function(e){e.O(0,[731,971,69,744],function(){return e(e.s=4634)}),_N_E=e.O()}]);